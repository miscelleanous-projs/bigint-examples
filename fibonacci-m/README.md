
# Fibonacci according to Matrix Exponention method

## Source code

```d
import std.stdio : writefln;
import std.bigint : BigInt;
import std.conv;
import std.range;

struct Matrix {
    BigInt a, b, c, d;
    
    // Multiplication
    Matrix opBinary(string op)(Matrix other) if (op == "*") {
        return Matrix(
            a * other.a + b * other.c,
            a * other.b + b * other.d,
            c * other.a + d * other.c,
            c * other.b + d * other.d
        );
    }
}

Matrix matrixPow(Matrix base, BigInt exponent) {
    if (exponent == 0) {
        // Identity matrix
        return Matrix(1.BigInt, 0.BigInt, 0.BigInt, 1.BigInt);
    } else if (exponent % 2 == 0) {
        auto halfPow = matrixPow(base, exponent / 2);
        
        return halfPow * halfPow;
    } else {
        return base * matrixPow(base, exponent - 1);
    }
}

// Fibonacci function using matrix exponentiation
BigInt fibonacci(int n) {
    if (n == 0) return 0.BigInt;
    
    Matrix base = Matrix(1.BigInt, 1.BigInt, 1.BigInt, 0.BigInt);
    Matrix result = matrixPow(base, BigInt(n - 1));
    
    return result.a;
}

void main() {
    writefln("\n%(%s\\\n%)", 9_999.fibonacci.text.chunks(80));
}
```

## Result

```text
20793608237133498072112648988642836825087036094015903119682945866528501423455686\
64892745603430522651559175734329719015801062479426725097317613381017990273803823\
17897483462355564831914315919245323944200280678103204087244146934628490626683870\
83308048250920654493340878733226377580847446324873797603734794648258113858631550\
40408101726038120291994389237094285260164739821355447908182359371542956694514931\
29936648467790904377992847736753792842706601751346648332663776986420121068913557\
91141872776934080803504956794094648292880566056364718187662668970758537383352677\
42083557415594565854200363476532454100612101244678568917149480326240860269309121\
16019739382294466360499015319632861596990778804277202892355393296718771829156434\
19079186525118678856821600897520171070499437657067342400871083908811800976259727\
43182053955425686946081535591845825339823438236043576275982317989611674842426954\
59246332046141379928508143520187384809235815539889908971514694061316956144977837\
20743461373756218685106856826090696339815490921253714537241866911604250597353747\
82373326817818219850924022695582641601669008474981607284358248861318482990538315\
01800478443537515542015738331055219809981238332532612286898240517778465884610797\
90807828367132384798451794011076569057522158680378961532160858387223882974380483\
93192954122210080031358068858500259887956646322142782044849256507310659580883740\
16489964235633861097820456341224678729218456064091743606356182168838125623216644\
42822952537577492715365321134204530686742435454505103269768144370118494906390254\
93494235890403150987736972243705338316536038859511698024592793522590153763492565\
48723808771830083010745694440024264364147569050945350728047646844921056800247399\
14490555904391369218696387092918189246157103450387050229300603241611410707453960\
08017092827795183476321670524248582080142386652663381608292144288309546325908047\
18193292017101478280252213856563402074897963176632788722076077910344317001127535\
58813478888727503825389066823098683355695718137867882982111710796422706778536913\
19234273336455672792801895398915310604737974128079409163942990879665029460353665\
1238230626
```
